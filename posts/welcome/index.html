<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Protect your SIP Servers from bad actors | Gavin Henry's Blog</title><meta name=keywords content="first"><meta name=description content="Learn about SentryPeer"><meta name=author content="Gavin"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ghenry.co.uk/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://ghenry.co.uk/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://ghenry.co.uk/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://ghenry.co.uk/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://ghenry.co.uk/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-475334-16","auto"),ga("send","pageview"))</script><meta property="og:title" content="Protect your SIP Servers from bad actors"><meta property="og:description" content="Learn about SentryPeer"><meta property="og:type" content="article"><meta property="og:url" content="https://ghenry.co.uk/posts/welcome/"><meta property="og:image" content="https://ghenry.co.uk/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-03T15:01:03+00:00"><meta property="article:modified_time" content="2022-10-03T15:01:03+00:00"><meta property="og:site_name" content="Gavin Henry's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ghenry.co.uk/%3Cimage%20path/url%3E"><meta name=twitter:title content="Protect your SIP Servers from bad actors"><meta name=twitter:description content="Learn about SentryPeer"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ghenry.co.uk/posts/"},{"@type":"ListItem","position":2,"name":"Protect your SIP Servers from bad actors","item":"https://ghenry.co.uk/posts/welcome/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Protect your SIP Servers from bad actors","name":"Protect your SIP Servers from bad actors","description":"Learn about SentryPeer","keywords":["first"],"articleBody":"Protect your SIP Servers from bad actors Introduction SentryPeer® is a fraud detection tool. It lets bad actors try to make phone calls and saves the IP address they came from and number they tried to call. Those details can then be used to raise notifications at the service providers network and the next time a user/customer tries to call a collected number, you can act anyway you see fit.\nFor example:\nLet’s say you are running your own VoIP PBX on site. What SentryPeer will allow you to do in this context, is dip into the list of phone numbers (using the RESTful API) when your users are making outbound calls. If you get a hit, you’ll get a heads-up that potentially a device within your network is trying to call known probing phone numbers that have either been:\nNumbers collected by SentryPeer nodes you are running yourself Numbers seen by other SentryPeer nodes which have been replicated to your node via the peer to peer network This would allow you to generate a notification from your monitoring systems before you rack up any expensive calls or something worse happens.\nWhat would lead to this scenario?\nPotential voicemail fraud. This can happen if you allow calling an inbound number (your DID/DDI) to get to your voicemail system, then prompt for a PIN. This PIN is weak and the voicemail system allows you to press ‘*’ to call back the Caller ID that left a voicemail. The attacker has left a voicemail, and they then guess your PIN and call it back. The CLI is a known number that SentryPeer has seen. You can alert on it. A device has been hijacked and/or a softphone or similar is using the credentials they stole off the phone’s GUI and is trying to register to your system and make calls to a number seen by SentryPeer. An innocent user is calling a phishing number or known expensive number etc. that SentryPeer has seen before. Traditionally this data is shipped to a central place, so you don’t own the data you’ve collected. This project is all about Peer to Peer sharing of that data. The user owning the data and various Service Provider / Network Provider related feeds of the data is the key bit for me. I’m sick of all the services out there that keep it and sell it. If you’ve collected it, you should have the choice to keep it and/or opt in to share it with other SentryPeer community members via p2p methods.\nFeatures All code Free/Libre and Open Source Software FAST User owns their data User can submit their own data if they want to (you need to enable p2p mode - -p) User gets other users’ data ONLY IF they opt in to submit their data to the pool Embedded Distributed Hash Table (DHT) node using OpenDHT (-p cli option) Peer to Peer sharing of collected bad_actors using OpenDHT (default on) Peer to Peer data replication to receive collected bad_actors using OpenDHT (default on) Set your own DHT bootstrap node (-b cli option) Multithreaded UDP transport TCP transport TLS transport JSON logging to a file SIP mode can be disabled. This allows you to run SentryPeer in API mode or DHT mode only etc. i.e. not as a honeypot, but as a node in the SentryPeer community or to just serve replicated data SIP responsive mode can be enabled to collect data - cli / env flag Local data copy for fast access - cli / env db location flag Local API for fast access - cli / env flag WebHook for POSTing bad actor json to a central location - cli / env flag Query API for IP addresses of bad actors Query API for IPSET of bad actors Query API for a particular IP address of a bad actor Query API for attempted phone numbers called by bad actors Query API for an attempted phone number called by a bad actor Fail2Ban support via syslog as per feature request Local sqlite database - feature / cli flag Analytics - opt in SDKs/libs for external access - CGRateS to start with or our own firewall with nftables Small binary size for IoT usage Cross-platform Firewall options to use distributed data in real time - DHT? Container on Docker Hub for latest build BGP agent to peer with for blackholing collected IP addresses (similar to Team Cymru Bogon Router Server Project) SIP agent to return 404 or default destination for SIP redirects Talks TADSummit 2021 - https://blog.tadsummit.com/2021/11/17/sentrypeer/ CommCon 2021 - https://2021.commcon.xyz/talks/sentrypeer-a-distributed-peer-to-peer-list-of-bad-ip-addresses-and-phone-numbers-collected-via-a-sip-honeypot ClueCon Weekly 2022 - https://youtu.be/DFxGHJI_0Wg UKNOF49 2022 (presentation slides) - https://indico.uknof.org.uk/event/59/contributions/801/ Adoption Kali Linux Deutsche Telekom T-Pot - The All In One Honeypot Platform v22 onwards Design I started this because I wanted to do C network programming as all the projects I use daily are in C like PostgreSQL, OpenLDAP, FreeSWITCH, OpenSIPS, Asterisk etc. See Episode 414: Jens Gustedt on Modern C for why C is a good choice. For those interested, see my full podcast show list (https://www.se-radio.net/team/gavin-henry/) for Software Engineering Radio\nDocker You can run the latest version of SentryPeer with Docker. The latest version is available from Docker Hub. Or build yourself:\nsudo docker build --no-cache -t sentrypeer . sudo docker run -d -p 5050:5060/tcp -p 5060:5060/udp -p 8082:8082 -p 4222:4222/udp sentrypeer:latest Then you can check at http://localhost:8082/ip-addresses and http://localhost:8082/health-check to see if it’s running.\nEnvironment Variables ENV SENTRYPEER_DB_FILE=/my/location/sentrypeer.db ENV SENTRYPEER_API=1 ENV SENTRYPEER_WEBHOOK_URL=https://my.webhook.url/events ENV SENTRYPEER_SIP_RESPONSIVE=1 ENV SENTRYPEER_SIP_DISABLE=1 ENV SENTRYPEER_SYSLOG=1 ENV SENTRYPEER_PEER_TO_PEER=1 ENV SENTRYPEER_BOOTSTRAP_NODE=mybootstrapnode.com ENV SENTRYPEER_JSON_LOG=1 ENV SENTRYPEER_JSON_LOG_FILE=/my/location/sentrypeer_json.log ENV SENTRYPEER_VERBOSE=1 ENV SENTRYPEER_DEBUG=1 Either set these in the Dockerfile or in your Dockerfile.env file or docker run command.\nInstallation Debian or Fedora packages are always available from the release page for the current version of SentryPeer:\nhttps://github.com/SentryPeer/SentryPeer/releases\nHomebrew (macOS or Linux): We have a Homebrew Tap for this project (until we get more popular):\nbrew tap sentrypeer/sentrypeer brew install sentrypeer Alpine Linux: SentryPeer is in testing on Alpine Linux, so you can install it with the following command:\napk -U add --no-cache -X https://dl-cdn.alpinelinux.org/alpine/edge/testing sentrypeer Ubuntu Package You can install SentryPeer from our Ubuntu PPD which is currently for Ubuntu 20 LTS (Focal Fossa):\nsudo apt install software-properties-common sudo add-apt-repository ppa:gavinhenry/sentrypeer sudo apt-get update This PPA can be added to your system manually by copying the lines below and adding them to your system’s software sources:\ndeb https://ppa.launchpadcontent.net/gavinhenry/sentrypeer/ubuntu focal main deb-src https://ppa.launchpadcontent.net/gavinhenry/sentrypeer/ubuntu focal main Then you can install SentryPeer:\nsudo apt-get install sentrypeer Building from source You have two options for installation from source. CMake or autotools. Autotools is recommended at the moment. A release is an autotools build.\nIf you are a Fedora user, you can install this via Fedora copr:\nhttps://copr.fedorainfracloud.org/coprs/ghenry/SentryPeer/\nIf you are going to build from this repository, you will need to have the following installed:\ngit, autoconf, automake and autoconf-archive (Debian/Ubuntu) libosip2-dev (Debian/Ubuntu) or libosip2-devel (Fedora) libsqlite3-dev (Debian/Ubuntu) or sqlite-devel (Fedora) uuid-dev (Debian/Ubuntu) or libuuid-devel (Fedora) libmicrohttpd-dev (Debian/Ubuntu) or libmicrohttpd-devel (Fedora) libjansson-dev (Debian/Ubuntu) or jansson-devel (Fedora) libpcre2-dev (Debian/Ubuntu) or pcre2-devel (Fedora) libcurl-dev (Debian/Ubuntu) or libcurl-devel (Fedora) libcmocka-dev (Debian/Ubuntu) or libcmocka-devel (Fedora) - for unit tests Debian/Ubuntu:\nsudo apt-get install git build-essential autoconf-archive autoconf automake libosip2-dev libsqlite3-dev \\ libcmocka-dev uuid-dev libcurl4-openssl-dev libpcre2-dev libjansson-dev libmicrohttpd-dev Fedora:\nsudo dnf install git autoconf automake autoconf-archive libosip2-devel libsqlite3-devel libcmocka-devel \\ libuuid-devel libmicrohttpd-devel jansson-devel libcurl-devel pcre2-devel macOS:\nbrew install git autoconf automake autoconf-archive libosip cmocka libmicrohttpd jansson curl pcre2 then (make check is highly recommended):\n./bootstrap.sh ./configure make make check make install Running SentryPeer Once built, you can run like so to start in debug mode, respond to SIP probes, enable the RESTful API, enable WebHooks and enable syslog logging (use a package if you want systemd):\n./sentrypeer -draps SentryPeer node id: e5ac3a88-3d52-4e84-b70c-b2ce83992d02 Starting sentrypeer... API mode enabled, starting http daemon... SIP mode enabled... Peer to Peer DHT mode enabled... Starting peer to peer DHT mode using OpenDHT-C lib version '2.4.0'... Configuring local address... Creating sockets... Binding sockets to local address... Listening for incoming UDP connections... SIP responsive mode enabled. Will reply to SIP probes... Listening for incoming TCP connections... Peer to peer DHT mode started. DHT InfoHash for key 'bad_actors' is: 14d30143330e2e0e922ed4028a60ff96a59800ad Bootstrapping the DHT Waiting 5 seconds for bootstrapping to bootstrap.sentrypeer.org... Listening for changes to the bad_actors DHT key when you get a probe request, you can see something like the following in the terminal:\nReceived (411 bytes): OPTIONS sip:100@XXX.XXX.XXX.XXX SIP/2.0 Via: SIP/2.0/UDP 91.223.3.152:5173;branch=z9hG4bK-515761064;rport Content-Length: 0 From: \"sipvicious\";tag=6434396633623535313363340131363131333837383137 Accept: application/sdp User-Agent: friendly-scanner To: \"sipvicious\" Contact: sip:100@91.223.3.152:5173 CSeq: 1 OPTIONS Call-ID: 679894155883566215079442 Max-Forwards: 70 read_packet_buf size is: 1024: read_packet_buf length is: 468: bytes_received size is: 411: Bad Actor is: Event Timestamp: 2021-11-23 20:13:36.427515810 Event UUID: fac3fa20-8c2c-445b-8661-50a70fa9e873 SIP Message: OPTIONS sip:100@XXX.XXX.XXX.XXX SIP/2.0 Via: SIP/2.0/UDP 91.223.3.152:5173;branch=z9hG4bK-515761064;rport From: \"sipvicious\" ;tag=6434396633623535313363340131363131333837383137 To: \"sipvicious\" Call-ID: 679894155883566215079442 CSeq: 1 OPTIONS Contact: Accept: application/sdp User-agent: friendly-scanner Max-forwards: 70 Content-Length: 0 Source IP: 193.107.216.27 Called Number: 100 SIP Method: OPTIONS Transport Type: UDP User Agent: friendly-scanner Collected Method: responsive Created by Node Id: fac3fa20-8c2c-445b-8661-50a70fa9e873 SentryPeer db file location is: sentrypeer.db Destination IP address of UDP packet is: xx.xx.xx.xx You can see the data in the sqlite3 database called sentrypeer.db using sqlitebrowser or sqlite3 command line tool.\nHere’s a screenshot of the database opened using sqlitebrowser (it’s big, so I’ll just link to the image):\nsqlitebrowser exploring the sentrypeer.db\nWebHook There is a WebHook to POST a JSON Log Format payload to SentryPeerHQ or your own WebHook endpoint. The WebHook is not enabled by default. You can configure the WebHook URL via -w or set the SENTRYPEER_WEBHOOK_URL env variable.\nRESTful API The RESTful API is complete for the current use cases. Please click the Watch button to be notified when more things come out :-)\nEndpoint /health-check Query the API to see if it’s alive:\ncurl -v -H \"Content-Type: application/json\" http://localhost:8082/health-check * Connected to localhost (127.0.0.1) port 8082 (#0) \u003e GET /health-check HTTP/1.1 \u003e Host: localhost:8082 \u003e User-Agent: curl/7.79.1 \u003e Accept: */* \u003e Content-Type: application/json \u003e * Mark bundle as not supporting multiuse \u003c HTTP/1.1 200 OK \u003c Date: Mon, 24 Apr 2022 11:16:25 GMT \u003c Content-Type: application/json \u003c Access-Control-Allow-Origin: * \u003c X-Powered-By: SentryPeer \u003c X-SentryPeer-Version: 1.4.0 \u003c Content-Length: 81 \u003c { \"status\": \"OK\", \"message\": \"Hello from SentryPeer!\", \"version\": \"1.0.0\" } Endpoint /ip-addresses List all the IP addresses that have been seen by SentryPeer:\ncurl -v -H \"Content-Type: application/json\" http://localhost:8082/ip-addresses * Connected to localhost (127.0.0.1) port 8082 (#0) \u003e GET /ip-addresses HTTP/1.1 \u003e Host: localhost:8082 \u003e User-Agent: curl/7.79.1 \u003e Accept: */* \u003e Content-Type: application/json \u003e * Mark bundle as not supporting multiuse \u003c HTTP/1.1 200 OK \u003c Date: Mon, 24 Jan 2022 11:17:05 GMT \u003c Content-Type: application/json \u003c Access-Control-Allow-Origin: * \u003c X-Powered-By: SentryPeer \u003c X-SentryPeer-Version: 1.0.0 \u003c Content-Length: 50175 \u003c { \"ip_addresses_total\": 396, \"ip_addresses\": [ { \"ip_address\": \"193.107.216.27\", \"seen_last\": \"2022-01-11 13:30:48.703603359\", \"seen_count\":\t\"1263\" }, { \"ip_address\": \"193.46.255.152\" \"seen_last\": \"2022-01-11 13:28:27.348926406\", \"seen_count\": \"3220\" } ... ] } Endpoint /ip-address/{ip-address} Query a single IP address:\ncurl -v -H \"Content-Type: application/json\" http://localhost:8082/ip-address/8.8.8.8 * Connected to localhost (127.0.0.1) port 8082 (#0) \u003e GET /ip-addresses/8.8.8.8 HTTP/1.1 \u003e Host: localhost:8082 \u003e User-Agent: curl/7.79.1 \u003e Accept: */* \u003e Content-Type: application/json \u003e * Mark bundle as not supporting multiuse \u003c HTTP/1.1 404 Not Found \u003c Date: Mon, 24 Jan 2022 11:17:57 GMT \u003c Content-Type: application/json \u003c Access-Control-Allow-Origin: * \u003c X-Powered-By: SentryPeer \u003c X-SentryPeer-Version: 1.0.0 \u003c Content-Length: 33 \u003c * Connection #0 to host localhost left intact { \"message\": \"No bad actor found\" } Endpoint /numbers/{phone-number} Query a phone number a bad actor tried to call with optional + prefix:\ncurl -v -H \"Content-Type: application/json\" http://localhost:8082/numbers/8784946812410967 * Connected to localhost (127.0.0.1) port 8082 (#0) \u003e GET /numbers/8784946812410967 HTTP/1.1 \u003e Host: localhost:8082 \u003e User-Agent: curl/7.79.1 \u003e Accept: */* \u003e Content-Type: application/json \u003e * Mark bundle as not supporting multiuse \u003c HTTP/1.1 200 OK \u003c Date: Mon, 24 Jan 2022 11:19:53 GMT \u003c Content-Type: application/json \u003c Access-Control-Allow-Origin: * \u003c X-Powered-By: SentryPeer \u003c X-SentryPeer-Version: 1.0.0 \u003c Content-Length: 46 \u003c { \"phone_number_found\": \"8784946812410967\" } Syslog and Fail2ban With sentrypeer -s, you parse syslog and use Fail2Ban to block the IP address of the bad actor:\nNov 30 21:32:16 localhost.localdomain sentrypeer[303741]: Source IP: 144.21.55.36, Method: OPTIONS, Agent: sipsak 0.9.7 JSON Log Format With sentrypeer -j, you can produce a JSON log file of the bad actor’s IP address and the phone number they tried to call plus other metadata (set a custom log file location with -l):\n{ \"app_name\":\"sentrypeer\", \"app_version\":\"v1.4.0\", \"event_timestamp\":\"2022-02-22 11:19:15.848934346\", \"event_uuid\":\"4503cc92-26cb-4b3e-bb33-69a83fa09321\", \"created_by_node_id\":\"4503cc92-26cb-4b3e-bb33-69a83fa09321\", \"collected_method\":\"responsive\", \"transport_type\":\"UDP\", \"source_ip\":\"45.134.144.128\", \"destination_ip\":\"XX.XX.XX.XX\", \"called_number\":\"0046812118532\", \"sip_method\":\"OPTIONS\", \"sip_user_agent\":\"friendly-scanner\", \"sip_message\":\"full SIP message\" } Command Line Options ./sentrypeer -h Usage: sentrypeer [-h] [-V] [-w] [-j] [-p] [-b bootstrap.example.com] [-f fullpath for sentrypeer.db] [-l fullpath for sentrypeer_json.log] [-r] [-R] [-a] [-s] [-v] [-d] Options: -h, Print this help -V, Print version -f, Set 'sentrypeer.db' location or use SENTRYPEER_DB_FILE env -j, Enable json logging or use SENTRYPEER_JSON_LOG env -p, Enable Peer to Peer mode or use SENTRYPEER_PEER_TO_PEER env -b, Set Peer to Peer bootstrap node or use SENTRYPEER_BOOTSTRAP_NODE env -a, Enable RESTful API mode or use SENTRYPEER_API env -w, Set WebHook URL for bad actor json POSTs or use SENTRYPEER_WEBHOOK_URL env -r, Enable SIP responsive mode or use SENTRYPEER_SIP_RESPONSIVE env -R, Disable SIP mode completely or use SENTRYPEER_SIP_DISABLE env -l, Set 'sentrypeer_json.log' location or use SENTRYPEER_JSON_LOG_FILE env -s, Enable syslog logging or use SENTRYPEER_SYSLOG env -v, Enable verbose logging or use SENTRYPEER_VERBOSE env -d, Enable debug mode or use SENTRYPEER_DEBUG env Report bugs to https://github.com/SentryPeer/SentryPeer/issues See https://sentrypeer.org for more information. IPv6 Multicast Address The project has an IANA IPv6 multicast address for the purpose of sending messages between SentryPeer peers.\nAddresses: FF0X:0:0:0:0:0:0:172 Description: SentryPeer Contact: Gavin Henry Registration Date: 2022-01-26 Please see http://www.iana.org/assignments/ipv6-multicast-addresses\nThe assigned variable-scope address – which can also be listed as “FF0X::172” for short – the “X” denotes any possible scope.\nLicense Great reading - How to choose a license for your own work\nThis work is dual-licensed under GPL 2.0 and GPL 3.0.\nSPDX-License-Identifier: GPL-2.0-only OR GPL-3.0-only\nContributing See CONTRIBUTING\nProject Website https://sentrypeer.org\nTrademark SENTRYPEER is a registered trademark of Gavin Henry\nQuestions, Bug reports, Feature Requests New issues can be raised at:\nhttps://github.com/SentryPeer/SentryPeer/issues\nIt’s okay to raise an issue to ask a question.\nSpecial Thanks Special thanks to:\npsanders from the Routr project for tips on re-working this README.md file. Fly.io for crediting the SentryPeer account for hosting the upcoming SentryPeer HQ web app on their infrastructure AppSignal for Application performance monitoring sponsorship in the SentryPeer HQ web app David Miller for the design of the SentryPeer Web GUI theme and logo. Very kind of you! @garymiller for the feature request of syslog and Fail2ban as per Fail2ban Integration via syslog #6 @joejag for the Pull Request for the start of Terraform recipes to launch SentryPeer on different cloud providers #12 ","wordCount":"2443","inLanguage":"en","image":"https://ghenry.co.uk/%3Cimage%20path/url%3E","datePublished":"2022-10-03T15:01:03Z","dateModified":"2022-10-03T15:01:03Z","author":{"@type":"Person","name":"Gavin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ghenry.co.uk/posts/welcome/"},"publisher":{"@type":"Organization","name":"Gavin Henry's Blog","logo":{"@type":"ImageObject","url":"https://ghenry.co.uk/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ghenry.co.uk/ accesskey=h title="Home (Alt + H)"><img src=https://ghenry.co.uk/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ghenry.co.uk/archives/ title=archive><span>archive</span></a></li><li><a href=https://ghenry.co.uk/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://ghenry.co.uk/categories/ title=categories><span>categories</span></a></li><li><a href=https://ghenry.co.uk/tags/ title=tags><span>tags</span></a></li><li><a href=https://www.se-radio.net/team/gavin-henry/ title=se-radio.net/ghenry><span>se-radio.net/ghenry</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ghenry.co.uk/>Home</a>&nbsp;»&nbsp;<a href=https://ghenry.co.uk/posts/>Posts</a></div><h1 class=post-title>Protect your SIP Servers from bad actors</h1><div class=post-description>Learn about SentryPeer</div><div class=post-meta><span title='2022-10-03 15:01:03 +0000 +0000'>October 3, 2022</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;2443 words&nbsp;·&nbsp;Gavin&nbsp;|&nbsp;<a href=https://github.com/ghenry/blog/blob/master/content/posts/welcome.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#protect-your-sip-servers-from-bad-actors>Protect your SIP Servers from bad actors</a><ul><li><a href=#introduction>Introduction</a></li><li><a href=#features>Features</a></li><li><a href=#talks>Talks</a></li><li><a href=#adoption>Adoption</a></li><li><a href=#design>Design</a></li><li><a href=#docker>Docker</a></li><li><a href=#installation>Installation</a></li><li><a href=#running-sentrypeer>Running SentryPeer</a></li><li><a href=#webhook>WebHook</a></li><li><a href=#restful-api>RESTful API</a></li><li><a href=#syslog-and-fail2ban>Syslog and Fail2ban</a></li><li><a href=#json-log-format>JSON Log Format</a></li><li><a href=#command-line-options>Command Line Options</a></li><li><a href=#ipv6-multicast-address>IPv6 Multicast Address</a></li><li><a href=#license>License</a></li><li><a href=#contributing>Contributing</a></li><li><a href=#project-website>Project Website</a></li><li><a href=#trademark>Trademark</a></li><li><a href=#questions-bug-reports-feature-requests>Questions, Bug reports, Feature Requests</a></li><li><a href=#special-thanks>Special Thanks</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=protect-your-sip-servers-from-bad-actors>Protect your SIP Servers from bad actors<a hidden class=anchor aria-hidden=true href=#protect-your-sip-servers-from-bad-actors>#</a></h2><h3 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h3><p>SentryPeer® is a fraud detection tool. It lets bad actors try to make phone calls and saves the IP address they came from and
number they tried to call. Those details can then be used to raise notifications at the service providers network and the next
time a user/customer tries to call a collected number, you can act anyway you see fit.</p><p>For example:</p><p>Let&rsquo;s say you are running your own VoIP PBX on site. What SentryPeer will allow you to do in this context,
is dip into the list of phone numbers (using the RESTful API) when your users are making outbound calls. If you get a hit,
you&rsquo;ll get a heads-up that potentially a device within your network is trying to call known probing phone numbers that
have either been:</p><ol><li>Numbers collected by SentryPeer nodes you are running yourself</li><li>Numbers seen by other SentryPeer nodes which have been replicated to your node via the peer to peer network</li></ol><p>This would allow you to generate a notification from your monitoring systems before you rack
up any expensive calls or something worse happens.</p><p>What would lead to this scenario?</p><ol><li>Potential voicemail fraud. This can happen if you allow calling an
inbound number (your DID/DDI) to get to your voicemail system, then
prompt for a PIN. This PIN is weak and the voicemail system allows you
to press &lsquo;*&rsquo; to call back the Caller ID that left a voicemail. The
attacker has left a voicemail, and they then guess your PIN and call it
back. The CLI is a known number that SentryPeer has seen. You can alert on it.</li><li>A device has been hijacked and/or a softphone or similar is using
the credentials they stole off the phone&rsquo;s GUI and is trying to
register to your system and make calls to a number seen by SentryPeer.</li><li>An innocent user is calling a phishing number or known expensive
number etc. that SentryPeer has seen before.</li></ol><p>Traditionally this data is shipped to a central place, so you don&rsquo;t own the data you&rsquo;ve collected. This project is all about Peer to Peer sharing of that data. The user owning the data and various Service Provider / Network Provider related feeds of the data is the key bit for me. I&rsquo;m sick of all the services out there that keep it and sell it. If you&rsquo;ve collected it, you should have the choice to keep it and/or opt in to share it with other SentryPeer community members via p2p methods.</p><h3 id=features>Features<a hidden class=anchor aria-hidden=true href=#features>#</a></h3><ul><li><input checked disabled type=checkbox> All code <a href=https://www.gnu.org/philosophy/floss-and-foss.en.html>Free/Libre and Open Source Software</a></li><li><input checked disabled type=checkbox> FAST</li><li><input checked disabled type=checkbox> User <em>owns their</em> data</li><li><input checked disabled type=checkbox> User can submit their own data if they want to (you need to enable p2p mode - <code>-p</code>)</li><li><input checked disabled type=checkbox> User gets other users&rsquo; data <strong>ONLY IF</strong> they opt in to submit their data to the pool</li><li><input checked disabled type=checkbox> Embedded Distributed Hash Table (DHT) node using <a href=https://github.com/savoirfairelinux/opendht/wiki/Running-a-node-in-your-program>OpenDHT</a> (<code>-p</code> cli option)</li><li><input checked disabled type=checkbox> Peer to Peer <strong>sharing</strong> of collected bad_actors using <a href=https://github.com/savoirfairelinux/opendht>OpenDHT</a> (default on)</li><li><input checked disabled type=checkbox> Peer to Peer data replication to <strong>receive</strong> collected bad_actors using <a href=https://github.com/savoirfairelinux/opendht>OpenDHT</a> (default on)</li><li><input checked disabled type=checkbox> Set your own DHT bootstrap node (<code>-b</code> cli option)</li><li><input checked disabled type=checkbox> Multithreaded</li><li><input checked disabled type=checkbox> UDP transport</li><li><input checked disabled type=checkbox> TCP transport</li><li><input disabled type=checkbox> TLS transport</li><li><input checked disabled type=checkbox> <a href=#json-log-format>JSON logging</a> to a file</li><li><input checked disabled type=checkbox> SIP mode can be disabled. This allows you to run SentryPeer in API mode or DHT mode only etc. i.e.
not as a honeypot, but as a node in the SentryPeer community or to just serve replicated data</li><li><input checked disabled type=checkbox> SIP responsive mode can be enabled to collect data - cli / env flag</li><li><input checked disabled type=checkbox> <strong>Local</strong> data copy for <strong>fast access</strong> - cli / env db location flag</li><li><input checked disabled type=checkbox> <strong>Local</strong> API for <strong>fast access</strong> - cli / env flag</li><li><input checked disabled type=checkbox> WebHook for POSTing bad actor json to a central location - cli / env flag</li><li><input checked disabled type=checkbox> Query API for IP addresses of bad actors</li><li><input disabled type=checkbox> Query API for IPSET of bad actors</li><li><input checked disabled type=checkbox> Query API for a particular IP address of a bad actor</li><li><input checked disabled type=checkbox> Query API for attempted phone numbers called by bad actors</li><li><input checked disabled type=checkbox> Query API for an attempted phone number called by a bad actor</li><li><input checked disabled type=checkbox> <a href=https://www.fail2ban.org/wiki/index.php/Main_Page>Fail2Ban</a> support via <code>syslog</code> as per <a href=https://github.com/SentryPeer/SentryPeer/issues/6>feature request</a></li><li><input checked disabled type=checkbox> Local <a href=https://www.sqlite.org/index.html>sqlite</a> database - feature / cli flag</li><li><input disabled type=checkbox> Analytics - opt in</li><li><input disabled type=checkbox> SDKs/libs for external access - <a href=https://github.com/cgrates/cgrates>CGRateS</a> to start with or our own firewall with nftables</li><li><input checked disabled type=checkbox> Small binary size for IoT usage</li><li><input checked disabled type=checkbox> Cross-platform</li><li><input disabled type=checkbox> Firewall options to use distributed data in real time - <a href=https://en.wikipedia.org/wiki/Distributed_hash_table>DHT</a>?</li><li><input checked disabled type=checkbox> Container on <a href=https://hub.docker.com/r/sentrypeer/sentrypeer>Docker Hub for latest build</a></li><li><input disabled type=checkbox> BGP agent to peer with for blackholing collected IP addresses (similar to <a href=https://team-cymru.com/community-services/bogon-reference/bogon-reference-bgp/>Team Cymru Bogon Router Server Project</a>)</li><li><input disabled type=checkbox> SIP agent to return 404 or default destination for SIP redirects</li></ul><h3 id=talks>Talks<a hidden class=anchor aria-hidden=true href=#talks>#</a></h3><ul><li>TADSummit 2021 - <a href=https://blog.tadsummit.com/2021/11/17/sentrypeer/>https://blog.tadsummit.com/2021/11/17/sentrypeer/</a></li><li>CommCon 2021 - <a href=https://2021.commcon.xyz/talks/sentrypeer-a-distributed-peer-to-peer-list-of-bad-ip-addresses-and-phone-numbers-collected-via-a-sip-honeypot>https://2021.commcon.xyz/talks/sentrypeer-a-distributed-peer-to-peer-list-of-bad-ip-addresses-and-phone-numbers-collected-via-a-sip-honeypot</a></li><li>ClueCon Weekly 2022 - <a href=https://youtu.be/DFxGHJI_0Wg>https://youtu.be/DFxGHJI_0Wg</a></li><li>UKNOF49 2022 (<a href=https://indico.uknof.org.uk/event/59/contributions/801/attachments/1033/1520/UKNOF-49-2022-SentryPeer.pdf>presentation slides</a>) - <a href=https://indico.uknof.org.uk/event/59/contributions/801/>https://indico.uknof.org.uk/event/59/contributions/801/</a></li></ul><h3 id=adoption>Adoption<a hidden class=anchor aria-hidden=true href=#adoption>#</a></h3><ul><li><a href=https://pkg.kali.org/pkg/sentrypeer>Kali Linux</a></li><li>Deutsche Telekom <a href=https://github.com/telekom-security/tpotce>T-Pot - The All In One Honeypot Platform</a> <a href=https://github.com/telekom-security/tpotce/releases/tag/22.04.0>v22</a> onwards</li></ul><p><img loading=lazy src="https://img.shields.io/matrix/sentrypeer:matrix.org?label=matrix&logo=matrix" alt=Matrix>
<a href=https://join.slack.com/t/sentrypeer/shared_invite/zt-zxsmfdo7-iE0odNT2XyKLP9pt0lgbcw><img loading=lazy src="https://img.shields.io/badge/join-us%20on%20slack-gray.svg?longCache=true&logo=slack&colorB=brightgreen" alt=slack></a>
<a href=https://twitter.com/SentryPeer><img loading=lazy src=https://img.shields.io/badge/follow-twitter-blue alt="SentryPeer on Twitter"></a></p><h3 id=design>Design<a hidden class=anchor aria-hidden=true href=#design>#</a></h3><p>I started this because I wanted to do <a href=https://github.com/codeplea/Hands-On-Network-Programming-with-C>C network programming</a> as all the projects I use daily are in C like <a href=https://www.postgresql.org/>PostgreSQL</a>, <a href=https://www.openldap.org/>OpenLDAP</a>, <a href=https://freeswitch.com/>FreeSWITCH</a>, <a href=https://opensips.org/>OpenSIPS</a>,
<a href=https://www.asterisk.org/>Asterisk</a> etc. See
<a href=https://www.se-radio.net/2020/06/episode-414-jens-gustedt-on-modern-c/>Episode 414: Jens Gustedt on Modern C</a> for why <a href=https://en.wikipedia.org/wiki/C_(programming_language)>C</a> is a good choice. For those interested, see my full podcast show list (<a href=https://www.se-radio.net/team/gavin-henry/>https://www.se-radio.net/team/gavin-henry/</a>) for <a href=https://www.se-radio.net/>Software Engineering Radio</a></p><h3 id=docker>Docker<a hidden class=anchor aria-hidden=true href=#docker>#</a></h3><p>You can run the latest version of SentryPeer with <a href=https://www.docker.com/>Docker</a>. The latest version is available from <a href=https://hub.docker.com/r/sentrypeer/sentrypeer/>Docker Hub</a>.
Or build yourself:</p><pre><code>sudo docker build --no-cache -t sentrypeer .
sudo docker run -d -p 5050:5060/tcp -p 5060:5060/udp -p 8082:8082 -p 4222:4222/udp sentrypeer:latest
</code></pre><p>Then you can check at <code>http://localhost:8082/ip-addresses</code> and <code>http://localhost:8082/health-check</code> to see if it&rsquo;s running.</p><h4 id=environment-variables>Environment Variables<a hidden class=anchor aria-hidden=true href=#environment-variables>#</a></h4><pre><code>ENV SENTRYPEER_DB_FILE=/my/location/sentrypeer.db
ENV SENTRYPEER_API=1
ENV SENTRYPEER_WEBHOOK_URL=https://my.webhook.url/events
ENV SENTRYPEER_SIP_RESPONSIVE=1
ENV SENTRYPEER_SIP_DISABLE=1
ENV SENTRYPEER_SYSLOG=1
ENV SENTRYPEER_PEER_TO_PEER=1
ENV SENTRYPEER_BOOTSTRAP_NODE=mybootstrapnode.com
ENV SENTRYPEER_JSON_LOG=1
ENV SENTRYPEER_JSON_LOG_FILE=/my/location/sentrypeer_json.log
ENV SENTRYPEER_VERBOSE=1
ENV SENTRYPEER_DEBUG=1
</code></pre><p>Either set these in the Dockerfile or in your <code>Dockerfile.env</code> file or docker run command.</p><h3 id=installation>Installation<a hidden class=anchor aria-hidden=true href=#installation>#</a></h3><p>Debian or Fedora packages are always available from the release page for the current version of SentryPeer:</p><p><a href=https://github.com/SentryPeer/SentryPeer/releases>https://github.com/SentryPeer/SentryPeer/releases</a></p><h4 id=homebrew-macos-or-linux>Homebrew (macOS or Linux):<a hidden class=anchor aria-hidden=true href=#homebrew-macos-or-linux>#</a></h4><p>We have a <a href=https://github.com/SentryPeer/homebrew-sentrypeer>Homebrew Tap for this project</a> (until we get more popular):</p><pre><code>brew tap sentrypeer/sentrypeer
brew install sentrypeer
</code></pre><h4 id=alpine-linux>Alpine Linux:<a hidden class=anchor aria-hidden=true href=#alpine-linux>#</a></h4><p>SentryPeer is in <a href=https://gitlab.alpinelinux.org/alpine/aports/-/tree/master/testing/sentrypeer>testing on Alpine Linux</a>, so you can install it with the following command:</p><pre><code>apk -U add --no-cache -X https://dl-cdn.alpinelinux.org/alpine/edge/testing sentrypeer
</code></pre><h4 id=ubuntu-package>Ubuntu Package<a hidden class=anchor aria-hidden=true href=#ubuntu-package>#</a></h4><p>You can install SentryPeer from <a href=https://launchpad.net/~gavinhenry/+archive/ubuntu/sentrypeer>our Ubuntu PPD</a> which
is currently for Ubuntu 20 LTS (Focal Fossa):</p><pre><code>sudo apt install software-properties-common
sudo add-apt-repository ppa:gavinhenry/sentrypeer
sudo apt-get update
</code></pre><p>This PPA can be added to your system manually by copying the lines below and adding them to your system&rsquo;s software
sources:</p><pre><code>deb https://ppa.launchpadcontent.net/gavinhenry/sentrypeer/ubuntu focal main 
deb-src https://ppa.launchpadcontent.net/gavinhenry/sentrypeer/ubuntu focal main
</code></pre><p>Then you can install SentryPeer:</p><pre><code>sudo apt-get install sentrypeer
</code></pre><h4 id=building-from-source>Building from source<a hidden class=anchor aria-hidden=true href=#building-from-source>#</a></h4><p>You have two options for installation from source. CMake or autotools. Autotools is recommended at the moment. A release is an autotools build.</p><p>If you are a Fedora user, you can install this via <a href=https://copr.fedorainfracloud.org/coprs/>Fedora copr</a>:</p><p><a href=https://copr.fedorainfracloud.org/coprs/ghenry/SentryPeer/>https://copr.fedorainfracloud.org/coprs/ghenry/SentryPeer/</a></p><p>If you are going to build from this repository, you will need to have the following installed:</p><ul><li><code>git</code>, <code>autoconf</code>, <code>automake</code> and <code>autoconf-archive</code> (Debian/Ubuntu)</li><li><code>libosip2-dev</code> (Debian/Ubuntu) or <code>libosip2-devel</code> (Fedora)</li><li><code>libsqlite3-dev</code> (Debian/Ubuntu) or <code>sqlite-devel</code> (Fedora)</li><li><code>uuid-dev</code> (Debian/Ubuntu) or <code>libuuid-devel</code> (Fedora)</li><li><code>libmicrohttpd-dev</code> (Debian/Ubuntu) or <code>libmicrohttpd-devel</code> (Fedora)</li><li><code>libjansson-dev</code> (Debian/Ubuntu) or <code>jansson-devel</code> (Fedora)</li><li><code>libpcre2-dev</code> (Debian/Ubuntu) or <code>pcre2-devel</code> (Fedora)</li><li><code>libcurl-dev</code> (Debian/Ubuntu) or <code>libcurl-devel</code> (Fedora)</li><li><code>libcmocka-dev</code> (Debian/Ubuntu) or <code>libcmocka-devel</code> (Fedora) - for unit tests</li></ul><p>Debian/Ubuntu:</p><pre><code>sudo apt-get install git build-essential autoconf-archive autoconf automake libosip2-dev libsqlite3-dev \
libcmocka-dev uuid-dev libcurl4-openssl-dev libpcre2-dev libjansson-dev libmicrohttpd-dev 
</code></pre><p>Fedora:</p><pre><code>sudo dnf install git autoconf automake autoconf-archive libosip2-devel libsqlite3-devel libcmocka-devel \
libuuid-devel libmicrohttpd-devel jansson-devel libcurl-devel pcre2-devel
</code></pre><p>macOS:</p><pre><code>brew install git autoconf automake autoconf-archive libosip cmocka libmicrohttpd jansson curl pcre2
</code></pre><p>then (make check is highly recommended):</p><pre><code>./bootstrap.sh
./configure
make
make check
make install
</code></pre><h3 id=running-sentrypeer>Running SentryPeer<a hidden class=anchor aria-hidden=true href=#running-sentrypeer>#</a></h3><p>Once built, you can run like so to start in <strong>debug mode</strong>, <strong>respond</strong> to SIP probes, enable the <strong>RESTful API</strong>,
enable WebHooks and enable syslog logging (<a href=https://github.com/SentryPeer/SentryPeer/releases>use a package</a> if you want <a href=https://www.freedesktop.org/wiki/Software/systemd/>systemd</a>):</p><pre><code>./sentrypeer -draps
SentryPeer node id: e5ac3a88-3d52-4e84-b70c-b2ce83992d02
Starting sentrypeer...
API mode enabled, starting http daemon...
SIP mode enabled...
Peer to Peer DHT mode enabled...
Starting peer to peer DHT mode using OpenDHT-C lib version '2.4.0'...
Configuring local address...
Creating sockets...
Binding sockets to local address...
Listening for incoming UDP connections...
SIP responsive mode enabled. Will reply to SIP probes...
Listening for incoming TCP connections...
Peer to peer DHT mode started.
DHT InfoHash for key 'bad_actors' is: 14d30143330e2e0e922ed4028a60ff96a59800ad
Bootstrapping the DHT
Waiting 5 seconds for bootstrapping to bootstrap.sentrypeer.org...
Listening for changes to the bad_actors DHT key
</code></pre><p>when you get a probe request, you can see something like the following in the terminal:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Received <span class=o>(</span><span class=m>411</span> bytes<span class=o>)</span>: OPTIONS sip:100@XXX.XXX.XXX.XXX SIP/2.0
</span></span><span class=line><span class=cl>Via: SIP/2.0/UDP 91.223.3.152:5173<span class=p>;</span><span class=nv>branch</span><span class=o>=</span>z9hG4bK-515761064<span class=p>;</span>rport
</span></span><span class=line><span class=cl>Content-Length: <span class=m>0</span>
</span></span><span class=line><span class=cl>From: <span class=s2>&#34;sipvicious&#34;</span>&lt;sip:100@1.1.1.1&gt;<span class=p>;</span><span class=nv>tag</span><span class=o>=</span><span class=m>6434396633623535313363340131363131333837383137</span>
</span></span><span class=line><span class=cl>Accept: application/sdp
</span></span><span class=line><span class=cl>User-Agent: friendly-scanner
</span></span><span class=line><span class=cl>To: <span class=s2>&#34;sipvicious&#34;</span>&lt;sip:100@1.1.1.1&gt;
</span></span><span class=line><span class=cl>Contact: sip:100@91.223.3.152:5173
</span></span><span class=line><span class=cl>CSeq: <span class=m>1</span> OPTIONS
</span></span><span class=line><span class=cl>Call-ID: <span class=m>679894155883566215079442</span>
</span></span><span class=line><span class=cl>Max-Forwards: <span class=m>70</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>read_packet_buf size is: 1024: 
</span></span><span class=line><span class=cl>read_packet_buf length is: 468: 
</span></span><span class=line><span class=cl>bytes_received size is: 411: 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Bad Actor is:
</span></span><span class=line><span class=cl>Event Timestamp: 2021-11-23 20:13:36.427515810
</span></span><span class=line><span class=cl>Event UUID: fac3fa20-8c2c-445b-8661-50a70fa9e873
</span></span><span class=line><span class=cl>SIP Message: OPTIONS sip:100@XXX.XXX.XXX.XXX SIP/2.0
</span></span><span class=line><span class=cl>Via: SIP/2.0/UDP 91.223.3.152:5173<span class=p>;</span><span class=nv>branch</span><span class=o>=</span>z9hG4bK-515761064<span class=p>;</span>rport
</span></span><span class=line><span class=cl>From: <span class=s2>&#34;sipvicious&#34;</span> &lt;sip:100@1.1.1.1&gt;<span class=p>;</span><span class=nv>tag</span><span class=o>=</span><span class=m>6434396633623535313363340131363131333837383137</span>
</span></span><span class=line><span class=cl>To: <span class=s2>&#34;sipvicious&#34;</span> &lt;sip:100@1.1.1.1&gt;
</span></span><span class=line><span class=cl>Call-ID: <span class=m>679894155883566215079442</span>
</span></span><span class=line><span class=cl>CSeq: <span class=m>1</span> OPTIONS
</span></span><span class=line><span class=cl>Contact: &lt;sip:100@91.223.3.152:5173&gt;
</span></span><span class=line><span class=cl>Accept: application/sdp
</span></span><span class=line><span class=cl>User-agent: friendly-scanner
</span></span><span class=line><span class=cl>Max-forwards: <span class=m>70</span>
</span></span><span class=line><span class=cl>Content-Length: <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Source IP: 193.107.216.27
</span></span><span class=line><span class=cl>Called Number: <span class=m>100</span>
</span></span><span class=line><span class=cl>SIP Method: OPTIONS
</span></span><span class=line><span class=cl>Transport Type: UDP
</span></span><span class=line><span class=cl>User Agent: friendly-scanner
</span></span><span class=line><span class=cl>Collected Method: responsive
</span></span><span class=line><span class=cl>Created by Node Id: fac3fa20-8c2c-445b-8661-50a70fa9e873
</span></span><span class=line><span class=cl>SentryPeer db file location is: sentrypeer.db
</span></span><span class=line><span class=cl>Destination IP address of UDP packet is: xx.xx.xx.xx
</span></span></code></pre></div><p>You can see the data in the sqlite3 database called <code>sentrypeer.db</code> using <a href=https://sqlitebrowser.org/>sqlitebrowser</a> or sqlite3 command line tool.</p><p>Here&rsquo;s a screenshot of the database opened using <a href=https://sqlitebrowser.org/>sqlitebrowser</a> (it&rsquo;s big, so I&rsquo;ll just link to the image):</p><p><a href=./screenshots/SentryPeer-sqlitebrowser.png>sqlitebrowser exploring the sentrypeer.db</a></p><h3 id=webhook>WebHook<a hidden class=anchor aria-hidden=true href=#webhook>#</a></h3><p>There is a WebHook to POST a <a href=#json-log-format>JSON Log Format</a> payload to <a href=https://github.com/SentryPeer/SentryPeer_HQ>SentryPeerHQ</a> or
your own WebHook endpoint. The WebHook is <strong>not</strong> enabled by default. You can configure the WebHook URL via <code>-w</code> or set
the <code>SENTRYPEER_WEBHOOK_URL</code> env variable.</p><h3 id=restful-api>RESTful API<a hidden class=anchor aria-hidden=true href=#restful-api>#</a></h3><p>The RESTful API is complete for the current use cases. Please click the Watch button to be notified when more things come out :-)</p><h4 id=endpoint-health-check>Endpoint /health-check<a hidden class=anchor aria-hidden=true href=#endpoint-health-check>#</a></h4><p>Query the API to see if it&rsquo;s alive:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -v -H <span class=s2>&#34;Content-Type: application/json&#34;</span> http://localhost:8082/health-check
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* Connected to localhost <span class=o>(</span>127.0.0.1<span class=o>)</span> port <span class=m>8082</span> <span class=o>(</span><span class=c1>#0)</span>
</span></span><span class=line><span class=cl>&gt; GET /health-check HTTP/1.1
</span></span><span class=line><span class=cl>&gt; Host: localhost:8082
</span></span><span class=line><span class=cl>&gt; User-Agent: curl/7.79.1
</span></span><span class=line><span class=cl>&gt; Accept: */*
</span></span><span class=line><span class=cl>&gt; Content-Type: application/json
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>* Mark bundle as not supporting multiuse
</span></span><span class=line><span class=cl>&lt; HTTP/1.1 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>&lt; Date: Mon, <span class=m>24</span> Apr <span class=m>2022</span> 11:16:25 GMT
</span></span><span class=line><span class=cl>&lt; Content-Type: application/json
</span></span><span class=line><span class=cl>&lt; Access-Control-Allow-Origin: *
</span></span><span class=line><span class=cl>&lt; X-Powered-By: SentryPeer
</span></span><span class=line><span class=cl>&lt; X-SentryPeer-Version: 1.4.0
</span></span><span class=line><span class=cl>&lt; Content-Length: <span class=m>81</span>
</span></span><span class=line><span class=cl>&lt; 
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;status&#34;</span>: <span class=s2>&#34;OK&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Hello from SentryPeer!&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;version&#34;</span>: <span class=s2>&#34;1.0.0&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h4 id=endpoint-ip-addresses>Endpoint /ip-addresses<a hidden class=anchor aria-hidden=true href=#endpoint-ip-addresses>#</a></h4><p>List all the IP addresses that have been seen by SentryPeer:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -v -H <span class=s2>&#34;Content-Type: application/json&#34;</span> http://localhost:8082/ip-addresses
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* Connected to localhost <span class=o>(</span>127.0.0.1<span class=o>)</span> port <span class=m>8082</span> <span class=o>(</span><span class=c1>#0)</span>
</span></span><span class=line><span class=cl>&gt; GET /ip-addresses HTTP/1.1
</span></span><span class=line><span class=cl>&gt; Host: localhost:8082
</span></span><span class=line><span class=cl>&gt; User-Agent: curl/7.79.1
</span></span><span class=line><span class=cl>&gt; Accept: */*
</span></span><span class=line><span class=cl>&gt; Content-Type: application/json
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>* Mark bundle as not supporting multiuse
</span></span><span class=line><span class=cl>&lt; HTTP/1.1 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>&lt; Date: Mon, <span class=m>24</span> Jan <span class=m>2022</span> 11:17:05 GMT
</span></span><span class=line><span class=cl>&lt; Content-Type: application/json
</span></span><span class=line><span class=cl>&lt; Access-Control-Allow-Origin: *
</span></span><span class=line><span class=cl>&lt; X-Powered-By: SentryPeer
</span></span><span class=line><span class=cl>&lt; X-SentryPeer-Version: 1.0.0
</span></span><span class=line><span class=cl>&lt; Content-Length: <span class=m>50175</span>
</span></span><span class=line><span class=cl>&lt; 
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ip_addresses_total&#34;</span>: 396,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ip_addresses&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;ip_address&#34;</span>: <span class=s2>&#34;193.107.216.27&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;seen_last&#34;</span>: <span class=s2>&#34;2022-01-11 13:30:48.703603359&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;seen_count&#34;</span>:	<span class=s2>&#34;1263&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;ip_address&#34;</span>: <span class=s2>&#34;193.46.255.152&#34;</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;seen_last&#34;</span>: <span class=s2>&#34;2022-01-11 13:28:27.348926406&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;seen_count&#34;</span>: <span class=s2>&#34;3220&#34;</span>      
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>  <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h4 id=endpoint-ip-addressip-address>Endpoint /ip-address/{ip-address}<a hidden class=anchor aria-hidden=true href=#endpoint-ip-addressip-address>#</a></h4><p>Query a single IP address:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -v -H <span class=s2>&#34;Content-Type: application/json&#34;</span> http://localhost:8082/ip-address/8.8.8.8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* Connected to localhost <span class=o>(</span>127.0.0.1<span class=o>)</span> port <span class=m>8082</span> <span class=o>(</span><span class=c1>#0)</span>
</span></span><span class=line><span class=cl>&gt; GET /ip-addresses/8.8.8.8 HTTP/1.1
</span></span><span class=line><span class=cl>&gt; Host: localhost:8082
</span></span><span class=line><span class=cl>&gt; User-Agent: curl/7.79.1
</span></span><span class=line><span class=cl>&gt; Accept: */*
</span></span><span class=line><span class=cl>&gt; Content-Type: application/json
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>* Mark bundle as not supporting multiuse
</span></span><span class=line><span class=cl>&lt; HTTP/1.1 <span class=m>404</span> Not Found
</span></span><span class=line><span class=cl>&lt; Date: Mon, <span class=m>24</span> Jan <span class=m>2022</span> 11:17:57 GMT
</span></span><span class=line><span class=cl>&lt; Content-Type: application/json
</span></span><span class=line><span class=cl>&lt; Access-Control-Allow-Origin: *
</span></span><span class=line><span class=cl>&lt; X-Powered-By: SentryPeer
</span></span><span class=line><span class=cl>&lt; X-SentryPeer-Version: 1.0.0
</span></span><span class=line><span class=cl>&lt; Content-Length: <span class=m>33</span>
</span></span><span class=line><span class=cl>&lt; 
</span></span><span class=line><span class=cl>* Connection <span class=c1>#0 to host localhost left intact</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;No bad actor found&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h4 id=endpoint-numbersphone-number>Endpoint /numbers/{phone-number}<a hidden class=anchor aria-hidden=true href=#endpoint-numbersphone-number>#</a></h4><p>Query a phone number a bad actor tried to call with optional <code>+</code> prefix:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -v -H <span class=s2>&#34;Content-Type: application/json&#34;</span> http://localhost:8082/numbers/8784946812410967
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* Connected to localhost <span class=o>(</span>127.0.0.1<span class=o>)</span> port <span class=m>8082</span> <span class=o>(</span><span class=c1>#0)</span>
</span></span><span class=line><span class=cl>&gt; GET /numbers/8784946812410967 HTTP/1.1
</span></span><span class=line><span class=cl>&gt; Host: localhost:8082
</span></span><span class=line><span class=cl>&gt; User-Agent: curl/7.79.1
</span></span><span class=line><span class=cl>&gt; Accept: */*
</span></span><span class=line><span class=cl>&gt; Content-Type: application/json
</span></span><span class=line><span class=cl>&gt; 
</span></span><span class=line><span class=cl>* Mark bundle as not supporting multiuse
</span></span><span class=line><span class=cl>&lt; HTTP/1.1 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>&lt; Date: Mon, <span class=m>24</span> Jan <span class=m>2022</span> 11:19:53 GMT
</span></span><span class=line><span class=cl>&lt; Content-Type: application/json
</span></span><span class=line><span class=cl>&lt; Access-Control-Allow-Origin: *
</span></span><span class=line><span class=cl>&lt; X-Powered-By: SentryPeer
</span></span><span class=line><span class=cl>&lt; X-SentryPeer-Version: 1.0.0
</span></span><span class=line><span class=cl>&lt; Content-Length: <span class=m>46</span>
</span></span><span class=line><span class=cl>&lt; 
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;phone_number_found&#34;</span>: <span class=s2>&#34;8784946812410967&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=syslog-and-fail2ban>Syslog and Fail2ban<a hidden class=anchor aria-hidden=true href=#syslog-and-fail2ban>#</a></h3><p>With <code>sentrypeer -s</code>, you parse syslog and use Fail2Ban to block the IP address of the bad actor:</p><pre tabindex=0><code class=language-syslog data-lang=syslog>Nov 30 21:32:16 localhost.localdomain sentrypeer[303741]: Source IP: 144.21.55.36, Method: OPTIONS, Agent: sipsak 0.9.7
</code></pre><h3 id=json-log-format>JSON Log Format<a hidden class=anchor aria-hidden=true href=#json-log-format>#</a></h3><p>With <code>sentrypeer -j</code>, you can produce a JSON log file of the bad actor&rsquo;s IP address and the phone number they tried to call
plus other metadata (set a custom log file location with <code>-l</code>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;app_name&#34;</span><span class=p>:</span><span class=s2>&#34;sentrypeer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;app_version&#34;</span><span class=p>:</span><span class=s2>&#34;v1.4.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;event_timestamp&#34;</span><span class=p>:</span><span class=s2>&#34;2022-02-22 11:19:15.848934346&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;event_uuid&#34;</span><span class=p>:</span><span class=s2>&#34;4503cc92-26cb-4b3e-bb33-69a83fa09321&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;created_by_node_id&#34;</span><span class=p>:</span><span class=s2>&#34;4503cc92-26cb-4b3e-bb33-69a83fa09321&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;collected_method&#34;</span><span class=p>:</span><span class=s2>&#34;responsive&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;transport_type&#34;</span><span class=p>:</span><span class=s2>&#34;UDP&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;source_ip&#34;</span><span class=p>:</span><span class=s2>&#34;45.134.144.128&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;destination_ip&#34;</span><span class=p>:</span><span class=s2>&#34;XX.XX.XX.XX&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;called_number&#34;</span><span class=p>:</span><span class=s2>&#34;0046812118532&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;sip_method&#34;</span><span class=p>:</span><span class=s2>&#34;OPTIONS&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;sip_user_agent&#34;</span><span class=p>:</span><span class=s2>&#34;friendly-scanner&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;sip_message&#34;</span><span class=p>:</span><span class=s2>&#34;full SIP message&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=command-line-options>Command Line Options<a hidden class=anchor aria-hidden=true href=#command-line-options>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./sentrypeer -h
</span></span><span class=line><span class=cl>Usage: sentrypeer <span class=o>[</span>-h<span class=o>]</span> <span class=o>[</span>-V<span class=o>]</span> <span class=o>[</span>-w<span class=o>]</span> <span class=o>[</span>-j<span class=o>]</span> <span class=o>[</span>-p<span class=o>]</span> <span class=o>[</span>-b bootstrap.example.com<span class=o>]</span> <span class=o>[</span>-f fullpath <span class=k>for</span> sentrypeer.db<span class=o>]</span> <span class=o>[</span>-l fullpath <span class=k>for</span> sentrypeer_json.log<span class=o>]</span> <span class=o>[</span>-r<span class=o>]</span> <span class=o>[</span>-R<span class=o>]</span> <span class=o>[</span>-a<span class=o>]</span> <span class=o>[</span>-s<span class=o>]</span> <span class=o>[</span>-v<span class=o>]</span> <span class=o>[</span>-d<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Options:
</span></span><span class=line><span class=cl>  -h,      Print this <span class=nb>help</span>
</span></span><span class=line><span class=cl>  -V,      Print version
</span></span><span class=line><span class=cl>  -f,      Set <span class=s1>&#39;sentrypeer.db&#39;</span> location or use SENTRYPEER_DB_FILE env
</span></span><span class=line><span class=cl>  -j,      Enable json logging or use SENTRYPEER_JSON_LOG env
</span></span><span class=line><span class=cl>  -p,      Enable Peer to Peer mode or use SENTRYPEER_PEER_TO_PEER env
</span></span><span class=line><span class=cl>  -b,      Set Peer to Peer bootstrap node or use SENTRYPEER_BOOTSTRAP_NODE env
</span></span><span class=line><span class=cl>  -a,      Enable RESTful API mode or use SENTRYPEER_API env
</span></span><span class=line><span class=cl>  -w,      Set WebHook URL <span class=k>for</span> bad actor json POSTs or use SENTRYPEER_WEBHOOK_URL env
</span></span><span class=line><span class=cl>  -r,      Enable SIP responsive mode or use SENTRYPEER_SIP_RESPONSIVE env
</span></span><span class=line><span class=cl>  -R,      Disable SIP mode completely or use SENTRYPEER_SIP_DISABLE env
</span></span><span class=line><span class=cl>  -l,      Set <span class=s1>&#39;sentrypeer_json.log&#39;</span> location or use SENTRYPEER_JSON_LOG_FILE env
</span></span><span class=line><span class=cl>  -s,      Enable syslog logging or use SENTRYPEER_SYSLOG env
</span></span><span class=line><span class=cl>  -v,      Enable verbose logging or use SENTRYPEER_VERBOSE env
</span></span><span class=line><span class=cl>  -d,      Enable debug mode or use SENTRYPEER_DEBUG env
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Report bugs to https://github.com/SentryPeer/SentryPeer/issues
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>See https://sentrypeer.org <span class=k>for</span> more information.
</span></span></code></pre></div><h3 id=ipv6-multicast-address>IPv6 Multicast Address<a hidden class=anchor aria-hidden=true href=#ipv6-multicast-address>#</a></h3><p>The project has an IANA IPv6 multicast address for the purpose of sending messages between SentryPeer peers.</p><pre><code>Addresses: FF0X:0:0:0:0:0:0:172
Description: SentryPeer
Contact: Gavin Henry &lt;ghenry at sentrypeer.org&gt;
Registration Date: 2022-01-26
</code></pre><p>Please see <a href=http://www.iana.org/assignments/ipv6-multicast-addresses>http://www.iana.org/assignments/ipv6-multicast-addresses</a></p><p>The assigned variable-scope address &ndash; which can also be listed as &ldquo;FF0X::172&rdquo; for short &ndash; the &ldquo;X&rdquo; denotes any possible scope.</p><h3 id=license>License<a hidden class=anchor aria-hidden=true href=#license>#</a></h3><p>Great reading - <a href=https://www.gnu.org/licenses/license-recommendations.en.html>How to choose a license for your own work</a></p><p>This work is dual-licensed under GPL 2.0 and GPL 3.0.</p><p><code>SPDX-License-Identifier: GPL-2.0-only OR GPL-3.0-only</code></p><h3 id=contributing>Contributing<a hidden class=anchor aria-hidden=true href=#contributing>#</a></h3><p>See <a href=./CONTRIBUTING.md>CONTRIBUTING</a></p><h3 id=project-website>Project Website<a hidden class=anchor aria-hidden=true href=#project-website>#</a></h3><p><a href=https://sentrypeer.org>https://sentrypeer.org</a></p><h3 id=trademark>Trademark<a hidden class=anchor aria-hidden=true href=#trademark>#</a></h3><p><a href=https://trademarks.ipo.gov.uk/ipo-tmcase/page/Results/1/UK00003700947><strong>SENTRYPEER</strong> is a registered trademark</a> of Gavin Henry</p><h3 id=questions-bug-reports-feature-requests>Questions, Bug reports, Feature Requests<a hidden class=anchor aria-hidden=true href=#questions-bug-reports-feature-requests>#</a></h3><p>New issues can be raised at:</p><p><a href=https://github.com/SentryPeer/SentryPeer/issues>https://github.com/SentryPeer/SentryPeer/issues</a></p><p>It&rsquo;s okay to raise an issue to ask a question.</p><h3 id=special-thanks>Special Thanks<a hidden class=anchor aria-hidden=true href=#special-thanks>#</a></h3><p>Special thanks to:</p><ul><li><a href=https://github.com/psanders>psanders</a> from the <a href=https://github.com/fonoster/routr>Routr</a> project for <a href=https://mobile.twitter.com/pedrosanders_/status/1554572884714070019>tips on re-working this README.md</a> file.</li><li><a href=https://fly.io>Fly.io</a> for crediting the SentryPeer account for hosting the upcoming SentryPeer HQ web app on their infrastructure</li><li><a href=https://www.appsignal.com/>AppSignal</a> for Application performance monitoring sponsorship in the SentryPeer HQ web app</li><li><a href=http://davidmiller.io/>David Miller</a> for the design of the SentryPeer <a href=./web-gui-theme>Web GUI theme</a> and <a href=./web-gui-theme/src/assets/logo.svg>logo</a>. Very kind of you!</li><li><a href=https://github.com/garyemiller>@garymiller</a> for the feature request of syslog and Fail2ban as per <a href=https://github.com/SentryPeer/SentryPeer/issues/6>Fail2ban Integration via syslog #6</a></li><li><a href=https://github.com/joejag>@joejag</a> for the <a href=https://github.com/SentryPeer/SentryPeer/pull/19>Pull Request</a> for the start of <a href=https://github.com/SentryPeer/SentryPeer/issues/12>Terraform recipes to launch SentryPeer on different cloud providers #12</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://ghenry.co.uk/tags/first/>first</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Protect your SIP Servers from bad actors on twitter" href="https://twitter.com/intent/tweet/?text=Protect%20your%20SIP%20Servers%20from%20bad%20actors&url=https%3a%2f%2fghenry.co.uk%2fposts%2fwelcome%2f&hashtags=first"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Protect your SIP Servers from bad actors on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fghenry.co.uk%2fposts%2fwelcome%2f&title=Protect%20your%20SIP%20Servers%20from%20bad%20actors&summary=Protect%20your%20SIP%20Servers%20from%20bad%20actors&source=https%3a%2f%2fghenry.co.uk%2fposts%2fwelcome%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Protect your SIP Servers from bad actors on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fghenry.co.uk%2fposts%2fwelcome%2f&title=Protect%20your%20SIP%20Servers%20from%20bad%20actors"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Protect your SIP Servers from bad actors on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fghenry.co.uk%2fposts%2fwelcome%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Protect your SIP Servers from bad actors on whatsapp" href="https://api.whatsapp.com/send?text=Protect%20your%20SIP%20Servers%20from%20bad%20actors%20-%20https%3a%2f%2fghenry.co.uk%2fposts%2fwelcome%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Protect your SIP Servers from bad actors on telegram" href="https://telegram.me/share/url?text=Protect%20your%20SIP%20Servers%20from%20bad%20actors&url=https%3a%2f%2fghenry.co.uk%2fposts%2fwelcome%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//ghenry.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2022 <a href=https://ghenry.co.uk/>Gavin Henry's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>